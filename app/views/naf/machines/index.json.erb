 <%
  rows = @machines.each do |machine|
    machine[11] = link_to image_tag('papertrail_machine.png',
                                    class: 'action',
                                    title: "View machine(id: #{machine[0]}, server:#{machine[1].blank? ? machine[2] : machine[1]}) log in Papertrail"),
                                    url_for({ controller: 'log_viewer', action: 'index', machine_id: machine[0] }),
                                    { target: '_blank', id: machine[0] }
    machine[11] << "&nbsp;&nbsp;".html_safe
    machine[11] << (link_to image_tag('papertrail_machine_runner.png',
                                      class: 'action',
                                      title: "View machine(id: #{machine[0]}, server:#{machine[1].blank? ? machine[2] : machine[1]}) runner log in Papertrail"),
                                      url_for({ controller: 'log_viewer', action: 'index', runner_id: ::Naf::Machine.find_by_id(machine[0]).machine_runners.first.try(:id) }),
                                      { target: '_blank', id: machine[0] })
    machine[11] << "&nbsp;&nbsp;".html_safe
    unless machine[10]
      machine[11] << (link_to image_tag('terminate.png',
                                        class: 'action',
                                        title: "Mark machine(id: #{machine[0]}, server:#{machine[1].blank? ? machine[2] : machine[1]}) down"),
                                        "#", { class: "terminate", id: machine[0] })
    end
    machine.delete_at(12)
    machine.delete_at(10)
  end
%>
<%= raw rows %>
